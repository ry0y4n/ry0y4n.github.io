{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{350:function(s,n,a){\"use strict\";a.r(n);var e=a(3),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[a(\"p\",[s._v(\"前回では\"),a(\"code\",[s._v(\"Firebase Authentication\")]),s._v(\"を使ってログイン機能の実装と周辺機能の実装を終えた．\")]),s._v(\" \"),a(\"p\",[s._v(\"今回は遂に完成させてデプロイまでいく．\")]),s._v(\" \"),a(\"p\",[a(\"RouterLink\",{attrs:{to:\"/views/プログラミング/2020/010601.html\"}},[s._v(\"React + Redux + Firebase を使ってログイン機能あり掲示板アプリ開発①\")])],1),s._v(\" \"),a(\"p\",[a(\"RouterLink\",{attrs:{to:\"/views/プログラミング/2020/010701.html\"}},[s._v(\"React + Redux + Firebase を使ってログイン機能あり掲示板アプリ開発②\")])],1),s._v(\" \"),a(\"p\",[a(\"RouterLink\",{attrs:{to:\"/views/プログラミング/2020/010801.html\"}},[s._v(\"React + Redux + Firebase を使ってログイン機能あり掲示板アプリ開発③\")])],1),s._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"\"}},[s._v(\"React + Redux + Firebase を使ってログイン機能あり掲示板アプリ開発④\")]),s._v(\"　←今ここ！！！\")]),s._v(\" \"),a(\"h2\",{attrs:{id:\"タイムスタンプを適切な時間フォーマットへ\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#タイムスタンプを適切な時間フォーマットへ\"}},[s._v(\"#\")]),s._v(\" タイムスタンプを適切な時間フォーマットへ\")]),s._v(\" \"),a(\"p\",[s._v(\"コンテンツ外観はかなり煮詰まってきたが，\"),a(\"code\",[s._v(\"ProjectSummary\")]),s._v(\"と\"),a(\"code\",[s._v(\"ProjectDetails\")]),s._v(\"での日付・時間表示がハードコーディングのままだ．\")]),s._v(\" \"),a(\"p\",[s._v(\"思い出して欲しいのは新しいプロジェクトを追加した時に\"),a(\"code\",[s._v(\"createdAt\")]),s._v(\"というフィールドを\"),a(\"code\",[s._v(\"firestore\")]),s._v(\"の\"),a(\"code\",[s._v(\"projects\")]),s._v(\"コレクションに保存したはずだ．この値は\"),a(\"code\",[s._v(\"タイムスタンプ\")]),s._v(\"だ．\")]),s._v(\" \"),a(\"p\",[s._v(\"これを適切なフォーマットに変換して表示するように，まずは\"),a(\"code\",[s._v(\"ProjectSummary\")]),s._v(\"から修正していこう．\")]),s._v(\" \"),a(\"p\",[a(\"code\",[s._v(\"toDate()\")]),s._v(\"メソッドはタイムスタンプをうまく変換してくれるが，こいつは\"),a(\"code\",[s._v(\"Dateオブジェクト\")]),s._v(\"と呼ばれるものなのでこのままだとエラーが出る．\")]),s._v(\" \"),a(\"p\",[s._v(\"なので\"),a(\"code\",[s._v(\"toString()\")]),s._v(\"メソッドで文字列に変換してあげる．\")]),s._v(\" \"),a(\"p\",[s._v(\"後，\"),a(\"code\",[s._v(\"projects\")]),s._v(\"の中にテスト用に作った\"),a(\"code\",[s._v(\"createdAt\")]),s._v(\"プロパティを持たないドキュメントがあるので手動で削除しよう．しないとエラーが出る．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-projects/ProjectsSummary.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v('import React from \\'react\\'\\n\\nconst ProjectSummary = ({project}) => {\\n    return (\\n        <div className=\"card z-depth-0 project-summary\">\\n            <div className=\"card-content grey-text text-darken-3\">\\n                <span className=\"card-title\">{project.title}</span>\\n                <p>Posted by the {project.authorFirstName} {project.authorLastName}</p>\\n                <p className=\"grey-text\">{project.createdAt.toDate().toString()}</p>\\n            </div>\\n        </div>\\n    )\\n}\\n\\nexport default ProjectSummary;\\n')])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\")])]),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-28 22.22.16.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/03e4209f-ae6a-47ca-e6d1-c6c2135d9d9e.png\"}}),s._v(\"\\n一応，人間様がみれるフォーマットにはなったが，なんだか不格好だ．\\n\"),a(\"p\",[s._v(\"なので\"),a(\"a\",{attrs:{href:\"https://momentjs.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"Moment.js\"),a(\"OutboundLink\")],1),s._v(\" と呼ばれるパッケージを使ってお好みなフォーマットを実装しよう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-terminal line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"npm install moment\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"インポートして使ってみる．\\n\"),a(\"code\",[s._v(\"Moment.js\")]),s._v(\"ではDateオブジェクトを扱うので\"),a(\"code\",[s._v(\"toString\")]),s._v(\"は消して全体を\"),a(\"code\",[s._v(\"moment\")]),s._v(\"関数で囲み，そこにお好みのメソッドをつける．\\n今回は\"),a(\"code\",[s._v(\"calendar\")]),s._v(\"メソッドを使う．他にもたくさん綺麗なフォーマットがあるので公式参照．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-projects/ProjectSummary.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v('import React from \\'react\\'\\nimport moment from \\'moment\\'\\n\\nconst ProjectSummary = ({project}) => {\\n    return (\\n        <div className=\"card z-depth-0 project-summary\">\\n            <div className=\"card-content grey-text text-darken-3\">\\n                <span className=\"card-title\">{project.title}</span>\\n                <p>Posted by the {project.authorFirstName} {project.authorLastName}</p>\\n                <p className=\"grey-text\">{moment(project.createdAt.toDate()).calendar()}</p>\\n            </div>\\n        </div>\\n    )\\n}\\n\\nexport default ProjectSummary;\\n')])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\")])]),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-28 22.32.50.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/31412d8a-77cf-f452-7407-d1bd31251550.png\"}}),s._v(\" \"),a(\"p\",[s._v(\"同じことを\"),a(\"code\",[s._v(\"ProjectDetails\")]),s._v(\"にも実装していく．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-projects/ProjectDetails.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"import React from 'react'\\nimport { connect } from 'react-redux'\\nimport { firestoreConnect } from 'react-redux-firebase'\\nimport { compose } from 'redux'\\nimport { Redirect } from 'react-router-dom'\\nimport moment from 'moment'\\n\\nconst ProjectDetails = (props) => {\\n    const { project, auth } = props;\\n    if (!auth.uid) return <Redirect to='/signin' />\\n    if (project) {\\n        return (\\n            <div className=\\\"container section project-details\\\">\\n                <div className=\\\"card z-depth-0\\\">\\n                    <div className=\\\"card-content\\\">\\n                        <span className=\\\"card-title\\\">{ project.title }</span>\\n                        <p>{ project.content }</p>\\n                    </div>\\n                    <div className=\\\"card-action gret lighten-4 grey-text\\\">\\n                        <div>Posted by {project.authorFirstName} {project.authorLastName}</div>\\n                        <div>{moment(project.createdAt.toDate()).calendar()}</div>\\n                    </div>\\n                </div>\\n            </div>\\n        )\\n    } else {\\n        return (\\n            <div className=\\\"container center\\\">\\n                <p>Loaging project...</p>\\n            </div>\\n        )\\n    }\\n    \\n}\\n\\nconst mapStateToProps = (state, ownProps) => {\\n    const id = ownProps.match.params.id;\\n    const projects = state.firestore.data.projects;\\n    const project = projects ? projects[id] : null\\n    return {\\n        project: project,\\n        auth: state.firebase.auth\\n    }\\n}\\n\\nexport default compose(\\n    connect(mapStateToProps),\\n    firestoreConnect([\\n        { collection: 'projects' }\\n    ])\\n)(ProjectDetails);\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"50\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"51\")]),a(\"br\")])]),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-28 22.35.08.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/1815a185-d876-9a67-9329-f2ee452b2dc8.png\"}}),s._v(\" \"),a(\"h2\",{attrs:{id:\"firestoreセキュリティルール\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#firestoreセキュリティルール\"}},[s._v(\"#\")]),s._v(\" Firestoreセキュリティルール\")]),s._v(\" \"),a(\"p\",[s._v(\"今，\"),a(\"code\",[s._v(\"Firestore\")]),s._v(\"はテストモードなので，誰でも読み書きが可能な状態にある．\")]),s._v(\" \"),a(\"p\",[s._v(\"現在のfirestoreのセキュリティルールをみると以下のようになっている．\")]),s._v(\" \"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-28 22.40.09.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/6d0eba6e-0020-e960-f6c7-e0974fe2600f.png\"}}),s._v(\"\\n1行目はセキュリティルール言語のバージョン情報なのであまり気にしないでいい．\\n2行目はルールが`firestore`データベースのみに適用されることを表している．\\n3行目はルールがプロジェクト内の全ての`firestore`データベース（我々は元々1つしかないけど）に適用されることを表している．\\n\"),a(\"p\",[s._v(\"なのでこの3行には手を加えないでいい．\")]),s._v(\" \"),a(\"p\",[s._v(\"4行目はルールがデータベースの全てのドキュメントに適用されることを表している．\\n5行目はデータベースの全てのドキュメントが誰にでも読み書き可能であることを設定している．\")]),s._v(\" \"),a(\"p\",[s._v(\"この設定は開発にはとても快適だが，いざデプロイする際には絶対にセキュリティをロックする必要がある．\")]),s._v(\" \"),a(\"p\",[s._v(\"シミュレータを使用して様々な状況をシミュレーションできる．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-28 22.55.06.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/5715d492-ee65-2d21-c5d8-8571b95faa06.png\"}}),s._v(\"\\n上画像では特定のプロジェクトの情報をログインしていないユーザーが\"),a(\"code\",[s._v(\"GET\")]),s._v(\"リクエストした場合のシミュレートだが，しっかりアクセスできてしまっている．\")]),s._v(\" \"),a(\"p\",[s._v(\"こんな感じでこのままだとデータベース内の情報にアクセスされるだけでなく，更新や削除もされてしまう危険性がある．\")]),s._v(\" \"),a(\"p\",[s._v(\"なので早速セキュリティルールを書き換えていこう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"rules_version = '2';\\nservice cloud.firestore {\\n  match /databases/{database}/documents {\\n    match /projects/{project} {\\n      allow read, write: if request.auth.uid != null\\n    }\\n  }\\n}\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\")])]),a(\"p\",[s._v(\"4行目はルールを\"),a(\"code\",[s._v(\"projects\")]),s._v(\"コレクションの全てのドキュメントに適用することを表している．\\n5行目で\"),a(\"code\",[s._v(\"request.auth.uid\")]),s._v(\"でログインステータスを確認し，ログインしているユーザーには読み込みと書き込みを許可している．\")]),s._v(\" \"),a(\"p\",[s._v(\"次に\"),a(\"code\",[s._v(\"users\")]),s._v(\"コレクションに対するルールも作っていく．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"rules_version = '2';\\nservice cloud.firestore {\\n  match /databases/{database}/documents {\\n    match /projects/{project} {\\n      allow read, write: if request.auth.uid != null\\n    }\\n    match /users/{useId} {\\n      allow create \\n      allow read: if request.auth.uid != null\\n    }\\n  }\\n}\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\")])]),a(\"p\",[s._v(\"7行目はルールが\"),a(\"code\",[s._v(\"users\")]),s._v(\"コレクションの全てのドキュメントにも適用されることを表している．\\n8行目は誰でもユーザーを登録することを許可している．\\n9行目はログインしているユーザーなら他のユーザー情報をみることを許可している．（ダッシュボード画面で他人のプロジェクトが見られるように）\")]),s._v(\" \"),a(\"p\",[s._v(\"以上のルールを書き込み\"),a(\"code\",[s._v(\"公開\")]),s._v(\"を押す．適用には数分かかることがあるので，少し待ってプロジェクトを作ったりしてアプリの動作がおかしくなってないか確認しよう．\")]),s._v(\" \"),a(\"p\",[s._v(\"今回実装してセキュリティルールはとても基本的なことだけなので，実際の開発では\"),a(\"a\",{attrs:{href:\"https://firebase.google.com/docs/rules?authuser=0\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"公式ドキュメント\"),a(\"OutboundLink\")],1),s._v(\"を読んで他にどんなルールを敷けるのか調べてみよう．\")]),s._v(\" \"),a(\"p\",[s._v(\"#Cloud Functionイントロ＆セットアップ\\nここまででReact Appを作ってきたが，ここまでのJavaScriptコードが全てクライアントサイド，ブラウザで実行されるものだ．コードを実行するのにサーバーを使用しなかった．\")]),s._v(\" \"),a(\"p\",[s._v(\"しかしいくつかのタスクに取り組むに際してサーバーサイドでコードを実行したい時が出てくる．\")]),s._v(\" \"),a(\"p\",[s._v(\"例えばクライアントサイドからはアクセスできないデータの編集などだ．\")]),s._v(\" \"),a(\"p\",[s._v(\"そのために\"),a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"を使えばコードをサーバーサイドで実行してくれる．\\nローカルでコードを書いてfirebaseにデプロイするだけでいい．\")]),s._v(\" \"),a(\"p\",[s._v(\"それでは書く前に\"),a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"のセットアップをしていこう．\")]),s._v(\" \"),a(\"p\",[s._v(\"Firebaseプロジェクトの\"),a(\"code\",[s._v(\"functions\")]),s._v(\"ページに行って\"),a(\"code\",[s._v(\"使ってみる\")]),s._v(\"をクリックすると，cloud functionを使うためのステップが出てくるの1つ1つやっていこう．\")]),s._v(\" \"),a(\"p\",[s._v(\"まず\"),a(\"code\",[s._v(\"firebase-tools\")]),s._v(\"のインストール\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-terminal line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"npm install -g firebase-tools\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"次に\"),a(\"code\",[s._v(\"firebase init\")]),s._v(\"と\"),a(\"code\",[s._v(\"firebaes deploy\")]),s._v(\"しろと出てくるが，その前にログインしないといけない．\\nもし初回ログインなら，ブラウザが開くと思う．\\nこのコマンドによりローカルマシンが Firebase に接続され，Firebase プロジェクトへのアクセスが許可される．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-terminal line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase login\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"次に\"),a(\"code\",[s._v(\"firebase init\")]),s._v(\"でfirebaseプロジェクトをフロントエンド側で初期化して\"),a(\"code\",[s._v(\"deploy\")]),s._v(\"するための準備をする．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-terminal line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase init\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[a(\"code\",[s._v(\"Which Firebase CLI features do you want to set up for this folder? Press Space to select features, then Enter to confirm your choices.\")]),s._v(\"のところは\"),a(\"code\",[s._v(\"Function\")]),s._v(\"と\"),a(\"code\",[s._v(\"Hosting\")]),s._v(\"だけを選択しよう．\")]),s._v(\" \"),a(\"p\",[a(\"code\",[s._v(\"Firestore\")]),s._v(\"を選択しないのはもうオンライン上でルールを設定しデプロイしたからだ．\")]),s._v(\" \"),a(\"p\",[s._v(\"次のところは\"),a(\"code\",[s._v(\"Use an existing project\")]),s._v(\"を選択．\\n次のところは今回作成しているfirebaseプロジェクトを選択．\\n次のところは\"),a(\"code\",[s._v(\"JavaScript\")]),s._v(\"を選択\\n次のところは\"),a(\"code\",[s._v(\"no\")]),s._v(\"を選択\\n次のところは\"),a(\"code\",[s._v(\"yes\")]),s._v(\"を選択\\n次のところは\"),a(\"code\",[s._v(\"build\")]),s._v(\"を選択\\n次のところは\"),a(\"code\",[s._v(\"no\")]),s._v(\"を選択\")]),s._v(\" \"),a(\"p\",[s._v(\"これでセットアップが完了した．アプリに\"),a(\"code\",[s._v(\"functions\")]),s._v(\"ファイルができていると思う．ここに\"),a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"用のコードを書いてデプロイする．\")]),s._v(\" \"),a(\"h2\",{attrs:{id:\"シンプルなcloud-fucntionを書いてみる\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#シンプルなcloud-fucntionを書いてみる\"}},[s._v(\"#\")]),s._v(\" シンプルなCloud Fucntionを書いてみる\")]),s._v(\" \"),a(\"p\",[s._v(\"まず\"),a(\"code\",[s._v(\"functions\")]),s._v(\"フォルダにある\"),a(\"code\",[s._v(\"index.js\")]),s._v(\"にあらかじめ用意されたダミーコードを説いていく．\")]),s._v(\" \"),a(\"p\",[s._v(\"1行目でモジュールをインポートしている．このモジュールの様々なプロパティを使ってコードを書いていく．\")]),s._v(\" \"),a(\"p\",[s._v(\"node.jsを書いたことのある人には馴染みやすいコードだと思う．特にexpressを書いたことのある人には．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-functions/index.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"const functions = require('firebase-functions');\\n\\n// // Create and Deploy Your First Cloud Functions\\n// // https://firebase.google.com/docs/functions/write-firebase-functions\\n//\\nexports.helloWorld = functions.https.onRequest((request, response) => {\\n response.send(\\\"Hello, ninjas!\\\");\\n});\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\")])]),a(\"p\",[s._v(\"この状態でfunctionsだけをデプロイしてみる．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase deploy --only functions\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"デプロイ後に表示されるURLで\"),a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"が実行できるのでアクセスしてみよう．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 0.21.08.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/d67c2b1b-bd0a-2c02-d1f7-5e7bb31b59cc.png\"}}),s._v(\"\\nfirebaseプロジェクトのfuncionsページでも確認します．\\n\"),a(\"code\",[s._v(\"helloWorld\")]),s._v(\"という関数が\"),a(\"code\",[s._v(\"HTTPリクエスト\")]),s._v(\"をトリガーに実行されることがちゃんと書いてある．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 0.22.10.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/f098d7a5-1b49-eeee-aa52-89682fc4685b.png\"}}),s._v(\"\\nということでとりあえず\"),a(\"code\",[s._v(\"Cloud Fucntion\")]),s._v(\"の基礎がわかったところで次は\"),a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"を使って，\"),a(\"code\",[s._v(\"Notifications\")]),s._v(\"の実装に取り組んでいきたいと思う．\\nNotificationsは誰かがサインアップしたりプロジェクトを作ったことをトリガーに通知するパネルのようなものである．\")]),s._v(\" \"),a(\"h2\",{attrs:{id:\"notificationコンポネント\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#notificationコンポネント\"}},[s._v(\"#\")]),s._v(\" Notificationコンポネント\")]),s._v(\" \"),a(\"p\",[s._v(\"具体的に何をトリガーにするかというと，誰かが\"),a(\"code\",[s._v(\"projects\")]),s._v(\"コレクションにドキュメントを追加した時か，誰かが\"),a(\"code\",[s._v(\"Firebase Authentication\")]),s._v(\"を使ってサインアップしたことをトリガーにしたい．\")]),s._v(\" \"),a(\"p\",[s._v(\"とはいえ現時点での\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"コンポネントはあまりに質素すぎるので，\"),a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"云々よりまずコンポネントの外観を作っていこう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-dashboard/Notification.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v('import React from \\'react\\'\\n\\nconst Notification = (props) => {\\n    return (\\n        <div className=\"section\">\\n            <div className=\"card z-depth-0\">\\n                <div className=\"card-content\">\\n                    <span className=\"card-title\">Notifications</span>\\n                    <ul className=\"notifications\">\\n                        <li>Notification</li>\\n                        <li>Notification</li>\\n                        <li>Notification</li>\\n                        <li>Notification</li>\\n                    </ul>\\n                </div>\\n            </div>\\n        </div>\\n    )\\n}\\n\\nexport default Notification;\\n')])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\")])]),a(\"p\",[s._v(\"これで外観はいい感じなので，次から実際にCloud Funcitonを書いていこうと思う．\")]),s._v(\" \"),a(\"h2\",{attrs:{id:\"firestoreのトリガー設定①\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#firestoreのトリガー設定①\"}},[s._v(\"#\")]),s._v(\" Firestoreのトリガー設定①\")]),s._v(\" \"),a(\"p\",[a(\"code\",[s._v(\"Cloud Function\")]),s._v(\"で2つの関数を実装していきたい．\")]),s._v(\" \"),a(\"p\",[s._v(\"1つはユーザーが新しいプロジェクトを作成した時，2つ目は新しいユーザーがサインアップした時をトリガーにする関数だ．\")]),s._v(\" \"),a(\"p\",[s._v(\"まずは前者に関する関数を実装していこう．\")]),s._v(\" \"),a(\"p\",[a(\"code\",[s._v(\"firebase\")]),s._v(\"内で他のサービス（AuthやFirestore）にアクセスするためにはまず\"),a(\"code\",[s._v(\"firebase-admin\")]),s._v(\"をインポートして初期化する必要がある．\")]),s._v(\" \"),a(\"p\",[a(\"code\",[s._v(\"projectCreated\")]),s._v(\"という関数を作成する．\\n詳しく知りたい人は\"),a(\"a\",{attrs:{href:\"https://firebase.google.com/docs/functions/firestore-events?hl=ja\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"Cloud Functions 公式ドキュメント\"),a(\"OutboundLink\")],1),s._v(\"を参照して欲しいのだが，ここでは\"),a(\"code\",[s._v(\"projects\")]),s._v(\"コレクションに新しいドキュメントが作られたことをトリガーに設定している．\")]),s._v(\" \"),a(\"p\",[s._v(\"中では，\"),a(\"code\",[s._v(\"doc\")]),s._v(\"というレスポンスを使って\"),a(\"code\",[s._v(\"notification\")]),s._v(\"オブジェクトを作成している．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-functions/index.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"const functions = require('firebase-functions');\\nconst admin = require('firebase-admin');\\nadmin.initializeApp(functions.config().firebase)\\n\\nexports.helloWorld = functions.https.onRequest((request, response) => {\\n response.send(\\\"Hello, ninjas!\\\");\\n});\\n\\nexports.projectCreated = functions.firestore\\n    .document('projects/{projectId}')\\n    .onCreate(doc => {\\n\\n        const project = doc.data();\\n        const notification = {\\n            content: 'Added a new project',\\n            user: `${project.authorFirstName} ${project.authorLastName}`,\\n            time: admin.firestore.FieldValue.serverTimestamp()\\n        }\\n})\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\")])]),a(\"p\",[s._v(\"ここまではトリガーと前処理しか書いていない．\\nあとはこの\"),a(\"code\",[s._v(\"notification\")]),s._v(\"オブジェクトをfirestoreの\"),a(\"code\",[s._v(\"notifications\")]),s._v(\"コレクションに追加したい．\")]),s._v(\" \"),a(\"p\",[s._v(\"そこで\"),a(\"code\",[s._v(\"notifications\")]),s._v(\"コレクションにドキュメントを追加する関数を外側に定義して\"),a(\"code\",[s._v(\"projectCreated\")]),s._v(\"で呼び出してあげよう．\\nこの関数は単に\"),a(\"code\",[s._v(\"projectCreated\")]),s._v(\"で呼び出すだけのものなので，Cloud Functions用の関数の書き方でなく，通常のJS文法でかける．\\nなお，Cloud Functions用の関数は何かしらのレスポンスが必要なので\"),a(\"code\",[s._v(\"return\")]),s._v(\"する形で関数を呼び出している．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-functions/index.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"const functions = require('firebase-functions');\\nconst admin = require('firebase-admin');\\nadmin.initializeApp(functions.config().firebase)\\n\\nexports.helloWorld = functions.https.onRequest((request, response) => {\\n response.send(\\\"Hello, ninjas!\\\");\\n});\\n\\nconst createNotification = (notification => {\\n    return admin.firestore().collection('notifications')\\n        .add(notification)\\n        .then(doc => console.log('notification added', doc));\\n})\\n\\nexports.projectCreated = functions.firestore\\n    .document('projects/{projectId}')\\n    .onCreate(doc => {\\n\\n        const project = doc.data();\\n        const notification = {\\n            content: 'Added a new project',\\n            user: `${project.authorFirstName} ${project.authorLastName}`,\\n            time: admin.firestore.FieldValue.serverTimestamp()\\n        }\\n\\n        return createNotification(Notification)\\n\\n})\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\")])]),a(\"p\",[s._v(\"それではこの関数をデプロイして確認してみよう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-terminal line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase deploy --only functions\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 10.10.21.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/f3aab8b7-e822-c68e-6081-de864adb1917.png\"}}),s._v(\"\\nちゃんとトリガーが起動するかどうか確かめるために新しいプロジェクトを作ってみよう．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 10.12.11.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/3211e4bf-54af-04b8-520e-f52e1335d99f.png\"}}),s._v(\" \"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 10.16.09.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/4dc5c360-0a3f-3b54-1131-42e8b5f74e34.png\"}}),s._v(\" \"),a(\"h2\",{attrs:{id:\"firestoreのトリガー設定②\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#firestoreのトリガー設定②\"}},[s._v(\"#\")]),s._v(\" Firestoreのトリガー設定②\")]),s._v(\" \"),a(\"p\",[s._v(\"次は誰かがサインアップしたことをトリガーにする関数を実装していく．\")]),s._v(\" \"),a(\"p\",[s._v(\"ここでも詳しい説明は\"),a(\"a\",{attrs:{href:\"https://firebase.google.com/docs/functions/firestore-events?hl=ja\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"Cloud Functions 公式ドキュメント\"),a(\"OutboundLink\")],1),s._v(\"に任せて，概要を説明していく．\")]),s._v(\" \"),a(\"p\",[s._v(\"新しいユーザーが作られたことをトリガーに\"),a(\"code\",[s._v(\".doc(user.uid).get()\")]),s._v(\"で作られたユーザーの情報を\"),a(\"code\",[s._v(\"users\")]),s._v(\"コレクションから取ってきて，データを元に\"),a(\"code\",[s._v(\"notification\")]),s._v(\"オブジェクトを作成．それを\"),a(\"code\",[s._v(\"createNotification\")]),s._v(\"関数へ渡す．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-functions/index.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"const functions = require('firebase-functions');\\nconst admin = require('firebase-admin');\\nadmin.initializeApp(functions.config().firebase)\\n\\nexports.helloWorld = functions.https.onRequest((request, response) => {\\n response.send(\\\"Hello, ninjas!\\\");\\n});\\n\\nconst createNotification = (notification => {\\n    return admin.firestore().collection('notifications')\\n        .add(notification)\\n        .then(doc => console.log('notification added', doc));\\n})\\n\\nexports.projectCreated = functions.firestore\\n    .document('projects/{projectId}')\\n    .onCreate(doc => {\\n\\n        const project = doc.data();\\n        const notification = {\\n            content: 'Added a new project',\\n            user: `${project.authorFirstName} ${project.authorLastName}`,\\n            time: admin.firestore.FieldValue.serverTimestamp()\\n        }\\n\\n        return createNotification(notification);\\n\\n})\\n\\nexports.userJoined = functions.auth.user()\\n    .onCreate(user => {\\n\\n        return admin.firestore().collection('users')\\n            .doc(user.uid).get().then(doc => {\\n                \\n                const newUser = doc.data();\\n                const notification = {\\n                    content: 'Joined the party',\\n                    user: `${newUser.firstName} ${newUser.lastName}`,\\n                    time: admin.firestore.FieldValue.serverTimestamp()\\n                }\\n\\n                return createNotification(notification);\\n\\n            })\\n\\n})\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),a(\"br\")])]),a(\"p\",[s._v(\"先ほどと同じようにデプロイして確認してみよう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-terminal line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase deploy --only functions\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 10.35.21.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/e9cc9df4-5c85-cd8d-df5d-c80e173394ac.png\"}}),s._v(\"\\nユーザーを作ってみて`notifications`コレクションに適切に保存されるか確認しよう．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 10.45.04.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/9bc8d7ed-b2e8-6b81-0b7e-21779e44c28f.png\"}}),s._v(\" \"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 10.46.02.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/3af7da06-0c6c-c633-1cb8-d875742431bb.png\"}}),s._v(\" \"),a(\"h2\",{attrs:{id:\"notification表示\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#notification表示\"}},[s._v(\"#\")]),s._v(\" Notification表示\")]),s._v(\" \"),a(\"p\",[s._v(\"あとは\"),a(\"code\",[s._v(\"notifications\")]),s._v(\"コレクションのドキュメントを取得して\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"コンポネントで表示してやろう．\")]),s._v(\" \"),a(\"p\",[s._v(\"そのためにはこのコンポネントとRedux\"),a(\"code\",[s._v(\"state\")]),s._v(\"とを\"),a(\"code\",[s._v(\"connect\")]),s._v(\"しないといけない．\\n\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"をラップしている\"),a(\"code\",[s._v(\"Dashboard\")]),s._v(\"ではすでにつながっているので後は\"),a(\"code\",[s._v(\"notifications\")]),s._v(\"コレクションとの同期をするだけだ．\")]),s._v(\" \"),a(\"p\",[s._v(\"特定の数（3）しか通知を表示したくないので\"),a(\"code\",[s._v(\"limit\")]),s._v(\"を3に設定した．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-dashboard/Dashboard.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"import React, { Component } from 'react'\\nimport Notification from './Notification'\\nimport ProjectList from '../projects/ProjectList'\\nimport { connect } from 'react-redux'\\nimport { firestoreConnect } from 'react-redux-firebase'\\nimport { compose } from 'redux'\\nimport { Redirect } from 'react-router-dom'\\n\\nclass Dashboard extends Component {\\n    render() {\\n        const { projects, auth, notifications } = this.props;\\n        if (!auth.uid) return <Redirect to='/signin' />\\n\\n        return (\\n            <div className=\\\"dashboard container\\\">\\n                <div className=\\\"row\\\">\\n                    <div className=\\\"col s12 m6\\\">\\n                        <ProjectList projects={projects} />\\n                    </div>\\n                    <div className=\\\"col s12 m5 offset-m1\\\">\\n                        <Notification notifications={notifications} />\\n                    </div>\\n                </div>\\n            </div>\\n        )\\n    }\\n}\\n\\nconst mapStateToProps = (state) => {\\n    return {\\n        projects: state.firestore.ordered.projects,\\n        auth: state.firebase.auth,\\n        notifications: state.firestore.ordered.notifications\\n    }\\n}\\n\\nexport default compose(\\n    connect(mapStateToProps),\\n    firestoreConnect([\\n        { collection: 'projects' },\\n        { collection: 'notifications', limit: 3 }\\n    ])\\n)(Dashboard);\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\")])]),a(\"p\",[s._v(\"後は\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"コンポネント側で適切に処理する．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-dashboard/Notification.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v('import React from \\'react\\'\\nimport moment from \\'moment\\'\\n\\nconst Notification = (props) => {\\n    const { notifications } = props;\\n    return (\\n        <div className=\"section\">\\n            <div className=\"card z-depth-0\">\\n                <div className=\"card-content\">\\n                    <span className=\"card-title\">Notifications</span>\\n                    <ul className=\"notifications\">\\n                        { notifications && notifications.map(item => {\\n                            return (\\n                                <li key={item.id}>\\n                                    <span className=\"pink-text\">{item.user} </span>\\n                                    <span>{item.content}</span>\\n                                    <div className=\"grey-text note-date\">\\n                                        {moment(item.time.toDate()).fromNow()}\\n                                    </div>\\n                                </li>\\n                            )\\n                        })}\\n                    </ul>\\n                </div>\\n            </div>\\n        </div>\\n    )\\n}\\n\\nexport default Notification;\\n')])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\")])]),a(\"p\",[s._v(\"これでもう終わりに見えるが，実はまだやってないことがある．\\n\"),a(\"code\",[s._v(\"notifications\")]),s._v(\"コレクションのセキュリティルールを設定していないのだ．\\nなのでこの状態ではエラーが出ると思う．\")]),s._v(\" \"),a(\"p\",[s._v(\"ということでルールを実装していこう．\")]),s._v(\" \"),a(\"p\",[s._v(\"ログインしているユーザーならいかなる\"),a(\"code\",[s._v(\"notification\")]),s._v(\"データを読めるようにする．そうしないと\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"コンポネントのところが見れなくなってしまう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"rules_version = '2';\\nservice cloud.firestore {\\n  match /databases/{database}/documents {\\n    match /projects/{project} {\\n      allow read, write: if request.auth.uid != null\\n    }\\n    match /users/{useId} {\\n    \\tallow create \\n      allow read: if request.auth.uid != null\\n    }\\n    match /notifications/{notification} {\\n      allow read: if request.auth.uid != null\\n    }\\n  }\\n}\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\")])]),a(\"p\",[s._v(\"これでうまく表示されるはずだ．新しいプロジェクトを追加してみて数秒後に\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"の載るかどうか確認してみよう．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 11.08.50.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/63a51bd6-e2a5-b4d8-8f67-ee7fe671c9bf.png\"}})]),s._v(\" \"),a(\"h2\",{attrs:{id:\"データの順番\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#データの順番\"}},[s._v(\"#\")]),s._v(\" データの順番\")]),s._v(\" \"),a(\"p\",[s._v(\"実装中に気づいていた人も多いだろう．\")]),s._v(\" \"),a(\"p\",[s._v(\"今の段階では\"),a(\"code\",[s._v(\"ProjectList\")]),s._v(\"も\"),a(\"code\",[s._v(\"Notification\")]),s._v(\"もランダムな順番でデータを羅列しているのだ．\\nプロジェクト一覧はまだしも通知欄がランダムに3つ取ってくるようでは致命的にダメだろう．\")]),s._v(\" \"),a(\"p\",[s._v(\"今回はその問題を解決していきたいと思う．\")]),s._v(\" \"),a(\"p\",[s._v(\"方法はめちゃくちゃ簡単だ．\")]),s._v(\" \"),a(\"p\",[a(\"code\",[s._v(\"Dashboard\")]),s._v(\"の\"),a(\"code\",[s._v(\"firestoreConnect\")]),s._v(\"のところで\"),a(\"code\",[s._v(\"orderBy\")]),s._v(\"で基準にしたいプロパティ整列の方向を指定してあげるだけだ．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-dashboard/Dashboard.js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"import React, { Component } from 'react'\\nimport Notification from './Notification'\\nimport ProjectList from '../projects/ProjectList'\\nimport { connect } from 'react-redux'\\nimport { firestoreConnect } from 'react-redux-firebase'\\nimport { compose } from 'redux'\\nimport { Redirect } from 'react-router-dom'\\n\\nclass Dashboard extends Component {\\n    render() {\\n        const { projects, auth, notifications } = this.props;\\n        if (!auth.uid) return <Redirect to='/signin' />\\n\\n        return (\\n            <div className=\\\"dashboard container\\\">\\n                <div className=\\\"row\\\">\\n                    <div className=\\\"col s12 m6\\\">\\n                        <ProjectList projects={projects} />\\n                    </div>\\n                    <div className=\\\"col s12 m5 offset-m1\\\">\\n                        <Notification notifications={notifications} />\\n                    </div>\\n                </div>\\n            </div>\\n        )\\n    }\\n}\\n\\nconst mapStateToProps = (state) => {\\n    return {\\n        projects: state.firestore.ordered.projects,\\n        auth: state.firebase.auth,\\n        notifications: state.firestore.ordered.notifications\\n    }\\n}\\n\\nexport default compose(\\n    connect(mapStateToProps),\\n    firestoreConnect([\\n        { collection: 'projects', orderBy: ['createdAt', 'desc'] },\\n        { collection: 'notifications', limit: 3, orderBy: ['time', 'desc'] }\\n    ])\\n)(Dashboard);\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\")])]),a(\"p\",[s._v(\"新しいプロジェクトを作ってみて，プロジェクト一覧のトップに表示されるかどうか，通知欄のトップの表示されるかを確認してみよう．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 11.20.59.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/6fbafd2c-d450-6dc5-ec98-c3de36b07ffc.png\"}})]),s._v(\" \"),a(\"h2\",{attrs:{id:\"firebase-hostingへデプロイ\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#firebase-hostingへデプロイ\"}},[s._v(\"#\")]),s._v(\" Firebase Hostingへデプロイ\")]),s._v(\" \"),a(\"p\",[s._v(\"ついにアプリが完成した．後は\"),a(\"code\",[s._v(\"Firebase Hosting\")]),s._v(\"へアプリをデプロイするだけだ．\")]),s._v(\" \"),a(\"p\",[s._v(\"まずは\"),a(\"code\",[s._v(\"Firebase Hosting\")]),s._v(\"のセットアップから始めよう．\")]),s._v(\" \"),a(\"p\",[s._v(\"FirebaseプロジェクトのHostingページへいき，\"),a(\"code\",[s._v(\"始める\")]),s._v(\"を押して設定を進めていこう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"npm install -g firebase-tools\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"も\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase login\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"も\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase init\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"もすでにやっているので後は\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase deploy\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"だけなのだが，その前にいくつかやることがある．アプリをビルドしないといけない．\")]),s._v(\" \"),a(\"p\",[s._v(\"なので以下のコマンドを打っていこう．\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"npm run build\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"するとアプリ内にデプロイするための\"),a(\"code\",[s._v(\"build\")]),s._v(\"フォルダが作られる．\")]),s._v(\" \"),a(\"p\",[s._v(\"よし準備は全て整った！デプロイしよう！\")]),s._v(\" \"),a(\"div\",{staticClass:\"language- line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[a(\"code\",[s._v(\"firebase deploy\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[a(\"code\",[s._v(\"deploy complete!\")]),s._v(\"と出たら君の勝ちだ．\")]),s._v(\" \"),a(\"p\",[s._v(\"Firebase Hostingページに表示されたURLにアクセスしてリダイレクトされたログイン画面が表示されれば完全勝利だ！\\nログインして動作確認してみるといい．\\n\"),a(\"img\",{attrs:{width:\"1680\",alt:\"スクリーンショット 2019-10-29 11.33.16.png\",src:\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/331294/17b70378-ea6d-d201-5a9f-5fd71f9c9531.png\"}})]),s._v(\" \"),a(\"h2\",{attrs:{id:\"終わりに\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#終わりに\"}},[s._v(\"#\")]),s._v(\" 終わりに\")]),s._v(\" \"),a(\"p\",[s._v(\"自分が偉いなんて思ってないことを大前提に，こういう海外の方が作られた英語コンテンツを翻訳・まとめてQiitaに流すのは倫理的にどうなのか少し悩みながらも，すごくよく出来た教材なので日本語ドキュメントとして共有した．\")]),s._v(\" \"),a(\"p\",[s._v(\"今後も同じように海外コンテンツのまとめはしていきたいのだが，このようにQiitaに流すのはアリなのだろうか？\")])])}),[],!1,null,null,null);n.default=t.exports}}]);","extractedComments":[]}